{"task":{"enable":true,"type":"script","public":false,"tags":[],"grace_time":0,"task_arguments":[{"id":1,"order":0,"type":"input","label":"task name","help":"","readonly":false,"required":true,"masked":false,"options":[]}],"output_parameters":[],"register_body":false,"execution_count":5,"multitasking":true,"user_inputs":false,"show_result":false,"_type":"ScriptTask","creation_date":"2020-01-10T16:50:06.154Z","last_update":"2020-01-10T17:03:32.362Z","env":{"ACCESS_TOKEN":""},"name":"Fetch Jobs","description":"","timeout":600000,"script_runas":"","script_id":"5e18a9d27ea59d0019c8d012"},"file":{"filename":"jobs_fetch.js","keyname":"jobs_fetch.js[ts:1578675807993]","size":2236,"description":"","md5":"93b23b489f77e97c30930e362ad06153","public":false,"tags":[],"data":"IyEvdXNyL2Jpbi9ub2RlanMKCmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKQpjb25zdCB0b2tlbiA9IHByb2Nlc3MuZW52LkFDQ0VTU19UT0tFTgoKaWYgKCF0b2tlbikgewogIC8vICBnbyB0byBhcHAudGhlZXllLmlvIGFuZCBjcmVhdGUgYW4gaW50ZWdyYXRpb24gYWNjZXNzIHRva2VuLgogIHRocm93IG5ldyBFcnJvcignQUNDRVNTX1RPS0VOIGVudiByZXF1aXJlZC4nKQp9CgpsZXQgam9iTmFtZSA9IHByb2Nlc3MuYXJndlsyXQoKCi8vIGN1cnJlbnQgY3VzdG9tZXIKbGV0IGN1c3RvbWVyTmFtZSA9IEpTT04ucGFyc2UocHJvY2Vzcy5lbnYuVEhFRVlFX09SR0FOSVpBVElPTl9OQU1FKQoKY29uc3QgbWFpbiA9IGFzeW5jICgpID0+IHsKICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChjdXN0b21lck5hbWUsIHsgbmFtZTogam9iTmFtZSB9KQogIGxldCBqb2JzID0gSlNPTi5wYXJzZShyZXNwb25zZSkKICBjb25zb2xlLmxvZyhqb2JzKQp9CgovKioKICogdGhlZXllIGpvYnMgYXBpCiAqLwpjb25zdCBmZXRjaCA9IChjdXN0b21lciwgd2hlcmUpID0+IHsKICBsZXQgcXVlcnlDdXN0b21lciA9IGVuY29kZVVSSUNvbXBvbmVudChjdXN0b21lcikKCiAgbGV0IHFzID0gYGFjY2Vzc190b2tlbj0ke3Rva2VufWAKICBmb3IgKGxldCBwcm9wIGluIHdoZXJlKSB7CiAgICBxcyArPSBgJndoZXJlWyR7cHJvcH1dPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHdoZXJlW3Byb3BdKX1gCiAgfQoKICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgaG9zdG5hbWU6ICdzdXBlcnZpc29yLnRoZWV5ZS5pbycsCiAgICAgIHBvcnQ6IDQ0MywKICAgICAgcGF0aDogYC8ke3F1ZXJ5Q3VzdG9tZXJ9L2pvYj8ke3FzfWAsCiAgICAgIG1ldGhvZDogJ0dFVCcKICAgIH0KCiAgICBjb25zb2xlLmxvZygnd2FpdGluZyBzZXJ2ZXIgcmVzcG9uc2UnKQogICAgY29uc3QgcmVxID0gaHR0cHMucmVxdWVzdChvcHRpb25zLCByZXMgPT4gewogICAgICBsZXQgc3RyID0gJycKCiAgICAgIHJlcy5vbignZGF0YScsIGQgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdwcm9ncmVzczogZG93bmxvYWRlZCAnICsgc3RyLmxlbmd0aCArICcgYnl0ZXMnKQogICAgICAgIC8vcHJvY2Vzcy5zdGRvdXQud3JpdGUoZCkKICAgICAgICBpZiAoZCkgeyBzdHIgKz0gZDsgfQogICAgICB9KQoKICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ3Byb2dyZXNzOiBkb3dubG9hZCBjb21wbGV0ZWQnKQogICAgICAgIHJldHVybiByZXNvbHZlKHN0cikKICAgICAgfSkKICAgIH0pCgogICAgcmVxLm9uKCdlcnJvcicsIGVycm9yID0+IHsKICAgICAgcmV0dXJuIHJlamVjdChlcnJvcikKICAgIH0pCgogICAgcmVxLmVuZCgpCiAgfSkKfQoKY29uc3QgY2FuY2VsID0gKGN1c3RvbWVyLCBqb2IpID0+IHsKICBsZXQgcXVlcnlDdXN0b21lciA9IGVuY29kZVVSSUNvbXBvbmVudChjdXN0b21lcikKICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgY29uc3Qgb3B0aW9ucyA9IHsKICAgICAgaG9zdG5hbWU6ICdzdXBlcnZpc29yLnRoZWV5ZS5pbycsCiAgICAgIHBvcnQ6IDQ0MywKICAgICAgcGF0aDogYC8ke3F1ZXJ5Q3VzdG9tZXJ9L2pvYi8ke2pvYi5pZH0vY2FuY2VsP2FjY2Vzc190b2tlbj0ke3Rva2VufWAsCiAgICAgIG1ldGhvZDogJ1BVVCcKICAgIH0KCiAgICBjb25zb2xlLmxvZygnd2FpdGluZyBzZXJ2ZXIgcmVzcG9uc2UnKQogICAgY29uc3QgcmVxID0gaHR0cHMucmVxdWVzdChvcHRpb25zLCByZXMgPT4gewogICAgICBsZXQgc3RyID0gJycKCiAgICAgIHJlcy5vbignZGF0YScsIGQgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdwcm9ncmVzczogZG93bmxvYWRlZCAnICsgc3RyLmxlbmd0aCArICcgYnl0ZXMnKQogICAgICAgIC8vcHJvY2Vzcy5zdGRvdXQud3JpdGUoZCkKICAgICAgICBpZiAoZCkgeyBzdHIgKz0gZDsgfQogICAgICB9KQoKICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ3Byb2dyZXNzOiBkb3dubG9hZCBjb21wbGV0ZWQnKQogICAgICAgIHJldHVybiByZXNvbHZlKHN0cikKICAgICAgfSkKICAgIH0pCgogICAgcmVxLm9uKCdlcnJvcicsIGVycm9yID0+IHsKICAgICAgcmV0dXJuIHJlamVjdChlcnJvcikKICAgIH0pCgogICAgcmVxLmVuZCgpCiAgfSkKfQoKbWFpbiAoKQ=="}}
